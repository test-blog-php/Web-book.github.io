<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>1</title>
  <link rel="stylesheet" href="../../css/framestyle.css">
</head>
<body>
<style type="text/css">* {font-size: 14pt;}</style>
<snap class="just">
<p align="center"><strong>ПРАКТИЧЕСКАЯ  РАБОТА №18.</strong></p>
<p>
  <strong>Тема: «Создание базы данных  средствами </strong><strong>MSAccess</strong><strong>»</strong></p>
<p>
  <strong>Цель работы: </strong>Освоить  основные приемы создания двухтабличной базы данных и отбора данных.<strong></strong></p>
<p>&nbsp;  </p>
<p><strong>Задача. </strong>Руководитель  торгового предприятия, реализующего научную литературу, заказал разработку базы  данных, основанной на двух таблицах. Одна таблица содержит данные, которые  могут отображаться для клиентов при оформлении закупки, — в ней указаны  розничные цены на книги. Вторая таблица предназначена для анализа результатов  деятельности предприятия — в ней содержатся закупочные, оптовые цены и краткая  информация о поставщиках (покупатели не имеют доступа к данным этой таблицы).</p>
<p>&nbsp;  </p>
<p><strong>Содержание работы: </strong><strong> </strong></p>
<ol>
  <li>Создание базовых таблиц: ключевой таблицы «Книги в  продаже» и не ключевой «Поставщики».</li>
  <li>Создание межтабличных связей.</li>
  <li>Создание запроса на выборку: отобрать книги, имеющих  объем не менее 400 страниц при цене менее 80 рублей. </li>
  <li> Создание  запроса с параметром: отобрать издания, предельную цену которых пользователь  задает сам при запуске запроса.</li>
</ol>
<p align="center">&nbsp;</p>
<p align="center"><strong>Технология  выполнение работы:</strong></p>
<p><strong><u>Задание 1.</u></strong> Создание  базовых таблиц. </p>
<p>
  1.  Запустите программу MSAccess&rsquo;2000/2003<strong>. </strong><em>(Пуск  - Программы - </em><em>MicrosoftAccess</em><em>).</em> </p>
<p>
  2.  В окне <strong><em>MicrosoftAccess</em></strong> выберите пункт меню <strong>Файл/Создать</strong> &gt; <strong>Новая база данных</strong>.</p>
<p><img src="img/18/1.png" alt=""/></p>
<p>
</p>
<p>
  3. В окне <em>Файл  новой базы данных</em> выберите вашу рабочую папку (например: <em>диск С, папку </em><em>Group</em><em>, 05ФК-2, 05БУА 3</em>)  и дайте файлу имя: <em>Книготорговля</em>. Убедитесь,  что в качестве типа файла выбрано <em>Базы  данных </em><em>MicrosoftAccess</em>, и щелкните на кнопке <em>Создать</em>. Откроется окно новой базы — <em>Книготорговля</em>.</p>
<p><img src="img/18/2.png" alt=""/></p>
<p>
</p>
<p>
  4.  Откройте панель <em>Таблицы</em> (открыта по  умолчанию).</p>
<p>
  5.  Дважды щелкните на значке <em>Создание  таблицы в режиме конструктора</em> — откроется бланк создания структуры таблицы.</p>
<p>
6. Для первой таблицы введите следующие поля:</p>
<table border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td width="310" valign="top"></p>Имя поля </td>
    <td width="310" valign="top"><p>Тип поля</p></td>
  </tr>
  <tr>
    <td width="310" valign="top"><p>Наименование</p></td>
    <td width="310" valign="top"><p>Текстовый</p></td>
  </tr>
  <tr>
    <td width="310" valign="top"><p>Автор</p></td>
    <td width="310" valign="top"><p>Текстовый</p></td>
  </tr>
  <tr>
    <td width="310" valign="top"><p>Объем</p></td>
    <td width="310" valign="top"><p>Числовой</p></td>
  </tr>
  <tr>
    <td width="310" valign="top"><p>Цена</p></td>
    <td width="310" valign="top"><p>Денежный</p></td>
  </tr>
  <tr>
    <td width="310" valign="top"><p>Примечание</p></td>
    <td width="310" valign="top"><p>МЕМО</p></td>
  </tr>
</table>
<p>7. Щелкните на поле <em>Объем</em>. В нижней части бланка задайте свойство <em>Число десятичных знаков равным 0</em>.</p>
<p><img src="img/18/3.png" alt=""/></p>
<p>
</p>
<p>
  8.  Для связи с будущей таблицей поставщиков надо задать ключевое поле. На  уникальность может претендовать поле <em>Наименование</em>,  но в больших базах данных возможно появление разных книг с одинаковым названием.  Поэтому мы используем комбинацию полей <em>Наименование</em> и <em>Автор</em>. Выделите оба поля в верхней  части бланка (выделение произведите слева от наименований полей при нажатой  клавише SHIFT).  Щелчком правой кнопки мыши откройте контекстное меню и выберите в нем пункт <em>Ключевое поле</em>.</p>
<p>
  9.  Закройте окно <em>Конструктора</em>. При  закрытии окна дайте таблице имя <em>Книги в  продаже</em>.</p>
<p>
  10.  Повторив действия пунктов 5-9, создайте таблицу <em>Поставщики</em>, в которую входят следующие поля:</p>
<table border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td width="310" valign="top"></p>Имя поля </td>
    <td width="310" valign="top"><p>Тип поля</p></td>
  </tr>
  <tr>
    <td width="310" valign="top"><p>Наименование</p></td>
    <td width="310" valign="top"><p>Текстовый</p></td>
  </tr>
  <tr>
    <td width="310" valign="top"><p>Автор</p></td>
    <td width="310" valign="top"><p>Текстовый</p></td>
  </tr>
  <tr>
    <td width="310" valign="top"><p>Цена оптовая</p></td>
    <td width="310" valign="top"><p>Денежный</p></td>
  </tr>
  <tr>
    <td width="310" valign="top"><p>Поставщик</p></td>
    <td width="310" valign="top"><p>Текстовый</p></td>
  </tr>
  <tr>
    <td width="310" valign="top"><p>Телефон</p></td>
    <td width="310" valign="top"><p>Текстовый</p></td>
  </tr>
  <tr>
    <td width="310" valign="top"><p>Адрес</p></td>
    <td width="310" valign="top"><p>Текстовый</p></td>
  </tr>
  <tr>
    <td width="310" valign="top"><p>Примечание</p></td>
    <td width="310" valign="top"><p>Мемо</p></td>
  </tr>
</table>
<p>Обратите  внимание на то, что поле номера телефона является текстовым, несмотря на то что  обычно номера телефонов записывают цифрами. Это связано с тем, что они не имеют  числового содержания. Номера телефонов не сравнивают по величине, не вычитают  из одного номера другой и т. д. Это типичное текстовое полe.</p>
<p>
  Ключевое  поле можно не задавать — для текущей задачи оно не требуется.</p>
<p>
  11. В <em>окне  Книготорговля: база данных</em> откройте по очереди созданные таблицы и  наполните их экспериментальным содержанием (10 записей). Закончив работу,  закройте таблицы.</p>
<p><img src="img/18/4.png" alt=""/></p>
<p>
</p>
<p>
  ВЫВОД.  Мы научились создавать таблицы базы данных, задавать их структуру, выбирать  типы полей и управлять их свойствами. Мы также освоили приемы наполнения таблиц  конкретным содержанием.</p>
<p>&nbsp;  </p>
<p><strong><u>Задание 2.</u></strong>  Создание межтабличных связей</p>
<p>
  1.  Разыщите на панели инструментов кнопку <em>Схема  данных</em>. Если есть сложности, найдите команду строки меню: <em>Сервис – Схема данных</em>. Воспользуйтесь  любым из этих средств, чтобы открыть окно Схема данных. Одновременно с  открытием этого окна открывается диалоговое окно <em>Добавление таблицы</em>, на вкладке <em>Таблицы</em> которого можно выбрать таблицы, между которыми создаются связи.</p>
<p>
  2.  Щелчком на кнопке <em>Добавить</em> выберите  таблицы <em>Книги в продаже</em> и <em>Поставщики</em> — в окне <em>Схема данных</em> откроются списки полей этих таблиц. Для выхода из  режима добавления таблиц нажмите кнопку <em>Закрыть</em>.</p>
<p>
  3.  При нажатой клавише <em>SHIFT</em> выделите в таблице <em>Книги в продаже </em>два поля: <em>Наименование</em> и <em>Автор</em>.</p>
<p>
  4.  Перетащите эти поля на список полей таблицы <em>Поставщики</em>.  При отпускании кнопки мыши автоматически откроется диалоговое окно <em>Изменение связей</em>.</p>
<p>
  5.  На правой панели окна <em>Изменение связей</em> выберите поля <em>Наименование</em> и <em>Автор</em> таблицы <em>Книги в продаже</em>, включаемые в связь. Не устанавливайте флажок <em>Обеспечение целостности данных</em> — в  данном упражнении это не требуется, но может препятствовать постановке учебных  опытов с таблицами.</p>
<p>
</p>
<p><img src="img/18/5.png" alt=""/></p>
<p><img src="img/18/6.png" alt=""/></p>
<p> </p>
<p>
  8.  Закройте диалоговое окно <em>Изменение связей</em> и в окне <em>Схема данных</em> рассмотрите  образовавшуюся связь. Убедитесь в том, что линию связи можно выделить щелчком  левой кнопки мыши, а щелчком правой кнопки мыши открывается контекстное меню,  позволяющее разорвать связь или отредактировать, ее;</p>
<p>
  9.  Закройте окно <em>Схема данных</em>. </p>
<p>&nbsp;  </p>
<p><strong><u>Задание3.</u></strong>  Создание запроса на выборку</p>
<p>
  Создадим  запрос на выборку книг, имеющих объем не менее 400 страниц при цене менее 80  рублей.</p>
<p>
  1.  В окне <em>Книготорговля: база данных</em> откройте панель <em>Запросы</em>. Дважды  щелкните на значке <em>Создание запроса в  режиме Конструктора</em> — откроется бланк запроса по образцу. Одновременно с  ним откроется диалоговое окно <em>Добавление  таблицы</em>.</p>
<p>
  2.  В окне <em>Добавление таблицы</em> выберите  таблицу <em>Книги в продаже</em> и щелкните на  кнопке <em>Добавить</em>. Закройте окно <em>Добавление таблицы</em>.</p>
<p><img src="img/18/7.png" alt=""/></p>
<p>
</p>
<p>
  3.  В списке полей таблицы <em>Книги в продаже</em> выберите поля, включаемые в результирующую таблицу: <em>Наименование, Автор, Объем, Цена</em>. Выбор производите двойными  щелчками на именах полей.</p>
<p>
  4.  Задайте условие отбора для поля <em>Объем</em>.  В соответствующую строку введите: <em>&gt;400</em>.  Из таблицы будут выбираться не все издания, а только те, объем которых  превышает 400 страниц.</p>
<p>
  5. Задайте условие отбора для поля <em>Цена</em>. В соответствующую строку введите: <em>&lt;80</em>. Теперь из таблицы будут  выбираться только издания, имеющие цену менее 80 рублей. </p>
<p><img src="img/18/8.png" alt=""/></p>
<p>
</p>
<p>
  6. Закройте бланк запроса по образцу. При закрытии  запроса введите его имя — <em>Выбор изданий</em>.</p>
<p>
  7.  В окне <em>Книготорговля: база данных</em> откройте только что созданный запрос и рассмотрите результирующую таблицу. Ее  содержательность зависит от того, что было введено в таблицу Книги в продаже  при ее наполнении. Если ни одно издание не соответствует условию отбора и  получившаяся результирующая таблица не имеет данных, откройте базовые таблицы и  наполните их модельными данными, позволяющими проверить работу запроса.</p>
<p>
  8.  По окончании исследований закройте все открытые объекты.</p>
<p>&nbsp;</p>
<p><strong><u>Задание 4.</u></strong>  Создание запросов «с параметром»</p>
<p>
  Выше  мы рассмотрели, как действует условие отбора, но должны отметить его  существенный недостаток. Пользователь базы данных работает с запросами, которые  ему подготовил разработчик. Если, например, разработчик предусмотрел запрос,  отбирающий издания, имеющие цену менее 80 рублей, то пользователь базы уже не в  состоянии отобрать книги, цена которых менее 150 рублей, поскольку у него нет  соответствующего запроса.</p>
<p>
  Специальный  тип запросов, называемый запросами «с параметром», позволяет пользователю  самому ввести критерий отбора данных на этапе запуска запроса. Этим приемом  обеспечивается гибкость работы с базой.</p>
<p>
  Создадим  простой запрос, позволяющий отбирать издания, предельную цену которых  пользователь может задать сам при запуске запроса.</p>
<p>
  1.  В окне <em>Книготорговля: база данных</em> откройте панель <em>Запросы</em>. Дважды  щелкните на значке <em>Создание запроса в  режиме Конструктора</em> — откроется бланк запроса по образцу.</p>
<p>
  2. Согласно предыдущему упражнению  создайте запрос на выборку, основанный на  таблице <em>Книги в продаже</em> и <em>Поставщики</em>,  в который войдут следующие поля:</p>
<p>
  •  Наименование;</p>
<p>
  • Автор;</p>
<p>
  •  Цена;</p>
<p>
  •  Поставщик.</p>
<p>
  3.  Строку <em>Условие отбора</em> для поля <em>Цена</em> надо заполнить таким образом, чтобы  при запуске запроса пользователь получал предложение ввести нужное значение.  Текст, обращенный к пользователю, должен быть заключен в квадратные скобки.  Если бы мы хотели отобрать книги, цена которых больше 100 рублей, мы бы  написали: &gt;100. Если бы нам были нужны книги дешевле 80 рублей, мы бы  написали &lt;80. Но если мы хотим дать пользователю возможность выбора, мы  должны написать: <em>&lt; [Введите  максимальную цену].</em></p>
<p><img src="img/18/9.png" alt=""/></p>
<p>
</p>
<p>6.  Закройте запрос. При закрытии сохраните его под именем <em>Выбор книг</em>.</p>
<p>
  7.  В окне <em>Книготорговля: база данных</em> откройте  панель <em>Запросы</em> и запустите запрос <em>Выбор книг</em> — на экране появится  диалоговое окно <em>Введите значение  параметра</em> .</p>
<p><img src="img/18/10.png" alt=""/></p>
<p>
</p>
<p>
  8.  Введите какое-либо число и щелкните на кнопке <em>ОК</em>. В зависимости от того, что реально содержится в таблице Книги в  продаже, по результатам запроса будет сформирована результирующая таблица.</p>
<p>
  9.  Закройте все объекты базы данных. </p></snap>
</body>
</html>